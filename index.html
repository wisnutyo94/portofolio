<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Booking De'Barba Barber</title>

<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">

<style>
* {
  box-sizing: border-box;
  font-family: 'Merriweather', serif;
}

body {
  background: #000;
  color: #fff;
  padding: 20px;
}

.container {
  max-width: 640px;
  margin: auto;
  background: #111;
  padding: 30px;
  border-radius: 20px;
}

h1 {
  text-align: center;
  margin-bottom: 25px;
}

.form-group {
  margin-bottom: 14px;
}

label {
  font-size: 13px;
  margin-bottom: 5px;
  display: block;
}

input, select {
  width: 100%;
  height: 46px;
  padding: 10px 14px;
  border-radius: 12px;
  border: 1px solid #333;
  background: #222;
  color: #fff;
  font-size: 14px;
  appearance: none;
}

input[type="date"] {
  height: 46px !important;
  padding-right: 14px;
}

input[type="date"]::-webkit-calendar-picker-indicator {
  filter: invert(1);
}

select option:disabled {
  color: #888;
}

button {
  width: 100%;
  padding: 14px;
  background: #fff;
  color: #000;
  border: none;
  border-radius: 14px;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
}

.powered {
  text-align: center;
  font-size: 12px;
  color: #777;
  margin-top: 20px;
}

/* BOX LIBUR */
.libur-box {
  display: none;
  text-align: center;
  padding: 20px;
  border-radius: 14px;
  background: #222;
  color: #fff;
}
</style>
</head>

<body>

<div class="container">
<h1>Booking De'Barba Barber</h1>

<!-- BOX LIBUR -->
<div id="liburBox" class="libur-box">
  <h3>✂️ De'Barba Barber Sedang Libur</h3>
  <p>Kami akan kembali melayani sesuai jadwal.</p>
</div>

<form id="bookingForm">

<div class="form-group">
<label>Nama Lengkap</label>
<input type="text" name="nama_lengkap" required>
</div>

<div class="form-group">
<label>Nomor Whatsapp</label>
<input type="text" name="nomor_whatsapp" required>
</div>

<div class="form-group">
<label>Email</label>
<input type="email" name="email" required>
</div>

<div class="form-group">
<label>Pilih Kapster</label>
<select name="pilih_kapster" required>
<option value="">-- Pilih Kapster --</option>
<option>Bayu "Boy"</option>
<option>Joel</option>
</select>
</div>

<div class="form-group">
<label>Pilih Layanan</label>
<select name="pilih_layanan" required>
<option value="">-- Pilih Layanan --</option>
<option>Regular Haircut - 50k</option>
<option>Coloring - 200k</option>
<option>Coloring - 300k</option>
<option>Coloring - 400k</option>
</select>
</div>

<div class="form-group">
<label>Pilih Tanggal</label>
<input type="date" id="tanggal" name="pilih_tanggal" required>
</div>

<div class="form-group">
<label>Pilih Jam</label>
<select id="jam" name="pilih_jam" required>
<option value="">-- Pilih Jam --</option>
</select>
</div>

<button type="submit">Booking Sekarang</button>
</form>

<div class="powered">Powered by De'Barba Barber © 2026</div>
</div>

<script>
// ================= SETTING =================
const IS_LIBUR = false; // true = TUTUP, false = BUKA

const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyE_COU2g1rgzF5Ggn4tXzrpf6r4l7rFSdYH-eftvXYjgkzZL9sMrqR3WKMV3Ven9C2/exec";
const NO_ADMIN_WA = "6285706706607";

// ================= LIBUR LOGIC =================
document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("bookingForm");
  const liburBox = document.getElementById("liburBox");

  if (IS_LIBUR) {
    form.style.display = "none";
    liburBox.style.display = "block";
  }
});

// ================= JAM BOOKING =================
const jamList = [];
for (let i = 11; i <= 23; i++) jamList.push(i.toString().padStart(2, "0") + ".00");

const tanggalInput = document.getElementById("tanggal");
const jamSelect = document.getElementById("jam");
const form = document.getElementById("bookingForm");

tanggalInput.min = new Date().toISOString().split("T")[0];

async function getBooked() {
  const res = await fetch(WEB_APP_URL);
  return await res.json();
}

async function updateJam() {
  const tgl = tanggalInput.value;
  if (!tgl) return;

  jamSelect.innerHTML = "<option>Loading...</option>";

  const booked = await getBooked();
  const bookedJam = booked[tgl] || [];

  jamSelect.innerHTML = '<option value="">-- Pilih Jam --</option>';

  jamList.forEach(jam => {
    const opt = document.createElement("option");
    opt.value = jam;

    if (bookedJam.includes(jam)) {
      opt.textContent = jam + " (Booked)";
      opt.disabled = true;
    } else {
      opt.textContent = jam;
    }
    jamSelect.appendChild(opt);
  });
}

tanggalInput.addEventListener("change", updateJam);

// ================= SUBMIT =================
form.addEventListener("submit", async e => {
  e.preventDefault();
  const data = new FormData(form);

  try {
    await fetch(WEB_APP_URL, { method: "POST", body: data });

    alert("Booking berhasil! Klik OK untuk menuju Whatsapp Admin");

    const text = `Hello, Mau BOOKING De'Barba Barber !\n\nNama: ${data.get("nama_lengkap")}\nWA: ${data.get("nomor_whatsapp")}\nKapster: ${data.get("pilih_kapster")}\nLayanan: ${data.get("pilih_layanan")}\nTanggal: ${data.get("pilih_tanggal")}\nJam: ${data.get("pilih_jam")}`;

    const waLink = /Android|iPhone|iPad/i.test(navigator.userAgent)
      ? `https://wa.me/${NO_ADMIN_WA}?text=${encodeURIComponent(text)}`
      : `https://web.whatsapp.com/send?phone=${NO_ADMIN_WA}&text=${encodeURIComponent(text)}`;

    window.location.href = waLink;

  } catch {
    alert("Gagal booking!");
  }
});
</script>

</body>
</html>
